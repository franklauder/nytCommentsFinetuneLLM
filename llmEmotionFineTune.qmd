---
title: "Fine Tuning LLM Emotion Predictions on New ork Times 2017 Comments"
format: html
---


# Introduction


# Data Inspection

```{python}

import torch


```

```{python}

import pandas as pd
import matplotlib as plt
import seaborn as sn


```

```{python}



from transformers import pipeline


```


```{python}


from transformers import AutoModel, AutoTokenizer
from transformers import AutoModelForSequenceClassification
from transformers import Trainer, TrainingArguments
from transformers.pipelines.pt_utils import KeyDataset
from tqdm.auto import tqdm





```


```{python}

from transformers.pipelines.pt_utils import KeyDataset




```

```{python}

from tqdm.auto import tqdm



```




```{python}


torch.cuda.is_available()



```


```{python}



file_path = r'C:\Users\fvlau\OneDrive\Documents\NYTEmotionBackup\nyt_comments17_with_emotions_clean.csv'


```


```{python}


nytComments17_emotion=pd.read_csv(file_path)



```



```{python}



nytComments17_emotion.info()



```


```{python}


print(nytComments17_emotion.shape)



```


```{python}

print(nytComments17_emotion["top_emotion"].value_counts())


```

```{python}

print(nytComments17_emotion["top_emotion"].value_counts(normalize=True).round(2))


```

From the value count ouput we see the top three emotions for out data set are trust, anticipation, and fear.  


```{python}


print(nytComments17_emotion["typeOfMaterial"].value_counts(normalize=True).round(2))


```

```{python}



print(nytComments17_emotion[["typeOfMaterial", "top_emotion"]].value_counts(normalize=True))


```


```{python}



nyt_emotionType_count=nytComments17_emotion[["typeOfMaterial", "top_emotion"]]



```


```{python}



nyt_emotionType_count.head()


```



```{python}



nyt_emotionType_count.groupby(['typeOfMaterial', 'top_emotion']).count()




```


# Model Fine Tuning

```{python}


pipe = pipeline("text-classification", model="avichr/hebEMO_anger")


```




```{python}


tokenizer = AutoTokenizer.from_pretrained("avichr/hebEMO_anger")
model = AutoModelForSequenceClassification.from_pretrained("avichr/hebEMO_anger")



```



