---
title: "Fine Tuning LLM Emotion Predictions on New ork Times 2017 Comments"
format: html
---


# Introduction


# Data Inspection

```{python}

import torch


```

```{python}

import pandas as pd
import matplotlib as plt
import seaborn as sn


```

```{python}



from transformers import pipeline


```


```{python}


from transformers import AutoModel, AutoTokenizer
from transformers import AutoModelForSequenceClassification
from transformers import Trainer, TrainingArguments
from transformers.pipelines.pt_utils import KeyDataset
from tqdm.auto import tqdm





```


```{python}

from transformers.pipelines.pt_utils import KeyDataset




```

```{python}

from tqdm.auto import tqdm



```




```{python}


torch.cuda.is_available()



```


```{python}



file_path = r'C:\Users\fvlau\OneDrive\Documents\nytCommentsFinetuneLLM\\nyt_comments17_with_sentiment.csv'


```


```{python}


nytComments17_sentiments=pd.read_csv(file_path)



```



```{python}



nytComments17_sentiments.info()



```


```{python}


print(nytComments17_sentiments.shape)



```


```{python}

print(nytComments17_sentiments["sentiment"].value_counts())


```

```{python}

print(nytComments17_sentiments["sentiment"].value_counts(normalize=True).round(2))


```




```{python}


print(nytComments17_sentiments["typeOfMaterial"].value_counts(normalize=True).round(2))


```

```{python}



print(nytComments17_sentiments["newDesk"].value_counts(normalize=True).round(2))



```

```{python}



print(nytComments17_sentiments[["typeOfMaterial", "sentiment"]].value_counts(normalize=True))


```

```{python}


print(nytComments17_sentiments[["newDesk", "sentiment"]].value_counts(normalize=True))



```


```{python}



nyt_emotionType_count=nytComments17_emotion[["typeOfMaterial", "top_emotion"]]



```


```{python}



nyt_emotionType_count.head()


```



```{python}



nyt_emotionType_count.groupby(['typeOfMaterial', 'top_emotion']).count()




```


# Model Fine Tuning

```{python}


pipe = pipeline("text-classification", model="avichr/hebEMO_anger")


```




```{python}


tokenizer = AutoTokenizer.from_pretrained("avichr/hebEMO_anger")
model = AutoModelForSequenceClassification.from_pretrained("avichr/hebEMO_anger")



```



